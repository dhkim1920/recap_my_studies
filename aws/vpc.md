# Amazon VPC

Amazon VPC는 AWS 클라우드 내에서 사용자 정의 가능한 논리적으로 격리된 가상 네트워크입니다. 
이를 통해 사용자는 자체 IP 주소 범위, 서브넷, 라우팅 테이블, 인터넷 게이트웨이 등을 설정하여 온프레미스 데이터 센터와 유사한 네트워크 환경을 구축할 수 있습니다.

# 주요 구성 요소

## VPC 및 서브넷

- **VPC**:  
  사용자가 정의한 IP 주소 범위를 갖는 가상 네트워크입니다.  
  AWS 리소스(EC2, RDS 등)를 네트워크적으로 논리적으로 분리해서 배치할 수 있는 공간을 의미합니다.

- **서브넷**:  
  VPC 내에서 IP 주소 범위를 분할한 하위 네트워크입니다.  
  각각의 서브넷은 특정 가용 영역(AZ, Availability Zone)에 속하며,  
  퍼블릭 서브넷(인터넷과 통신 가능한)과 프라이빗 서브넷(인터넷 통신 차단)으로 나눌 수 있습니다.  
  이를 통해 애플리케이션 계층 분리(웹 서버, DB 서버 분리) 같은 네트워크 설계가 가능합니다.

## IP 주소 지정

- **IPv4 및 IPv6 지원**:  
  VPC와 서브넷 모두 IPv4와 IPv6 주소를 지원합니다.  
  특히 IPv6는 인터넷 통신이 기본적으로 가능하기 때문에 보안 그룹이나 라우팅 설정이 더 중요해집니다.

- **퍼블릭 및 프라이빗 IP**:  
  퍼블릭 IP는 외부 인터넷과 통신하기 위해 EC2 인스턴스에 자동 또는 수동으로 할당됩니다.  
  반면, 프라이빗 IP는 VPC 내부 통신용으로 사용되며, 보안이나 내부 서비스 연결에 적합합니다.

## 라우팅 테이블

- 라우팅 테이블은 서브넷 또는 게이트웨이를 통해 흐르는 트래픽의 경로를 제어하는 핵심 구성입니다.  
- 기본적으로 VPC 내 서브넷끼리는 로컬(Local) 라우팅 테이블을 통해 서로 통신할 수 있도록 설정되어 있습니다.  
- 퍼블릭 서브넷은 외부 인터넷으로 나가는 라우팅(0.0.0.0/0 → IGW)을 추가해야 하며,  
  프라이빗 서브넷은 NAT 게이트웨이를 통한 라우팅을 구성하는 경우가 많습니다.

## 게이트웨이 및 엔드포인트

- **인터넷 게이트웨이 (IGW)**:  
  VPC를 퍼블릭 인터넷에 연결할 때 반드시 필요한 컴포넌트입니다.  
  퍼블릭 IP를 가진 리소스는 IGW를 통해 인터넷과 통신합니다.

- **NAT 게이트웨이**:  
  프라이빗 서브넷에 배치된 인스턴스가 인터넷으로 나가는 것은 허용하되,  
  외부에서 인스턴스를 직접 접근하지 못하게 막는 보안 패턴에 사용합니다.  
  주로 소프트웨어 업데이트, 외부 API 호출 등이 필요한 서버에 활용합니다.

- **VPC 엔드포인트**:  
  AWS S3, DynamoDB 같은 서비스에 직접 인터넷을 통해 접속하는 대신,  
  VPC 내부 네트워크 경로를 통해 연결할 수 있도록 지원합니다.  
  VPC 엔드포인트를 이용하면 데이터가 인터넷을 통과하지 않기 때문에 보안성이 높아집니다.

## 보안 구성

- **보안 그룹(Security Group)**:  
  인스턴스 단위에서 적용되는 가상 방화벽입니다.  
  인바운드(들어오는 트래픽)와 아웃바운드(나가는 트래픽) 규칙을 설정할 수 있으며, 상태 기반(Stateful) 방식을 따릅니다.  
  예를 들어 22번 포트(SSH)를 허용하면, 응답 패킷은 자동으로 허용됩니다.

- **네트워크 ACL(Network ACL)**:  
  서브넷 단위에 적용되는 방화벽입니다.  
  인바운드, 아웃바운드 각각에 대해 명시적으로 허용/거부 규칙을 설정해야 하며, Stateless(비상태적) 방식입니다.  
  따라서 응답 트래픽도 명시적으로 허용 규칙을 추가해야 합니다.

## VPC 피어링 및 전송 게이트웨이

- **VPC 피어링**:  
  서로 다른 VPC 간에 사설 IP로 통신할 수 있도록 연결해주는 기능입니다.  
  동일 계정 내 VPC뿐 아니라 다른 AWS 계정 소유 VPC와도 피어링이 가능합니다.  
  단, 피어링 연결은 트래픽이 직접 통과하는 구조이므로 VPC 간 IP 범위가 겹치지 않아야 합니다.

- **전송 게이트웨이(Transit Gateway)**:  
  여러 VPC, 온프레미스 네트워크(VPN, Direct Connect 등)를 중앙 집중형으로 연결할 수 있는 허브 역할을 합니다.  
  수십~수백 개의 VPC를 일일이 피어링하는 대신, Transit Gateway를 통해 효율적으로 네트워크를 관리할 수 있습니다.

# AWS GP2 볼륨 크기별 성능

## GP2 기본 성능 특성

### 핵심 공식
- **기본 IOPS**: `볼륨 크기(GiB) × 3 IOPS/GiB`
- **최대 IOPS**: `10,000 IOPS` (GP2 한계)
- **최대 처리량**: `250 MiB/s`
- **버스트 IOPS**: `3,000 IOPS` (1,000 GiB 미만만 해당)

> 참고)
> IOPS(Input/Output Operations Per Second)은 스토리지 장치가 1초에 처리할 수 있는 입출력 작업 횟수를 의미

### 주요 규칙
| 항목 | 규칙 | 제한사항 |
|:-----|:-----|:---------|
| **기본 성능** | 3 IOPS/GiB | 최대 10,000 IOPS |
| **버스트 성능** | 3,000 IOPS | 1,000 GiB 미만에서만 |
| **처리량** | 크기 비례 | 최대 250 MiB/s |
| **최대 성능 도달** | 3,334 GiB에서 10,000 IOPS | 그 이상은 의미 없음 |

---

## 크기별 성능 계산

### 소용량 (1,000 GiB 미만)
```
100 GiB 볼륨:
- 기본 IOPS: 100 × 3 = 300 IOPS
- 버스트 IOPS: 3,000 IOPS (사용 가능)
- 실제 성능: 300 IOPS (지속) + 3,000 IOPS (버스트)

500 GiB 볼륨:
- 기본 IOPS: 500 × 3 = 1,500 IOPS  
- 버스트 IOPS: 3,000 IOPS (사용 가능)
- 실제 성능: 1,500 IOPS (지속) + 3,000 IOPS (버스트)

1,000 GiB 볼륨:
- 기본 IOPS: 1,000 × 3 = 3,000 IOPS
- 버스트 IOPS: 없음 (기본이 이미 3,000)
- 실제 성능: 3,000 IOPS (지속)
```

### 중용량 (1,000 GiB ~ 3,334 GiB)
```
2,000 GiB 볼륨:
- 기본 IOPS: 2,000 × 3 = 6,000 IOPS
- 버스트: 없음
- 실제 성능: 6,000 IOPS

3,000 GiB 볼륨:
- 기본 IOPS: 3,000 × 3 = 9,000 IOPS
- 버스트: 없음  
- 실제 성능: 9,000 IOPS

3,334 GiB 볼륨:
- 기본 IOPS: 3,334 × 3 = 10,002 IOPS → 10,000 IOPS (제한)
- 실제 성능: 10,000 IOPS (최대값 도달)
```

### 대용량 (3,334 GiB 이상)
```
5,000 GiB 볼륨:
- 계산된 IOPS: 5,000 × 3 = 15,000 IOPS
- 실제 IOPS: 10,000 IOPS (GP2 한계)
- 비효율: 크기 대비 성능 향상 없음

10,000 GiB 볼륨:
- 계산된 IOPS: 10,000 × 3 = 30,000 IOPS  
- 실제 IOPS: 10,000 IOPS (GP2 한계)
- 비효율: 매우 비효율적
```

---

## 처리량 성능

### 처리량 계산 공식
GP2에서 최대 처리량 250 MiB/s를 달성하려면 **최소 334 GiB**가 필요합니다.

| 볼륨 크기 | 예상 처리량 | 실제 제한 |
|:----------|:------------|:----------|
| 100 GiB | ~75 MiB/s | 크기에 비례 |
| 334 GiB | 250 MiB/s | 최대값 도달 |
| 1,000 GiB | 250 MiB/s | 최대값 유지 |
| 3,000 GiB | 250 MiB/s | 최대값 유지 |

---

## 버스트 크레딧 시스템

### 버스트 가능 조건
- **대상**: 1,000 GiB 미만 볼륨만
- **버스트 IOPS**: 3,000 IOPS
- **크레딧**: 초기 540만 I/O 크레딧 제공

### 크레딧 소모/충전
```
100 GiB 볼륨 예시:
- 기본 성능: 300 IOPS
- 버스트 성능: 3,000 IOPS  
- 추가 소모: 2,700 IOPS (3,000 - 300)

크레딧 계산:
- 초기 크레딧: 5,400,000 I/O
- 고성능 지속 시간: 5,400,000 ÷ 2,700 = 약 33분
- 충전 속도: 300 IOPS (기본 성능과 동일)
```

---

## 성능 비교표

| 볼륨 크기 | 기본 IOPS | 버스트 IOPS | 지속 가능 IOPS | 처리량 | 
|:----------|:----------|:------------|:---------------|:-------|
| **100 GiB** | 300 | 3,000 | 300 | ~75 MiB/s |
| **500 GiB** | 1,500 | 3,000 | 1,500 | ~125 MiB/s |
| **1,000 GiB** | 3,000 | - | 3,000 | ~200 MiB/s |
| **2,000 GiB** | 6,000 | - | 6,000 | 250 MiB/s |
| **3,334 GiB** | 10,000 | - | 10,000 | 250 MiB/s |
| **5,000 GiB** | 10,000 | - | 10,000 | 250 MiB/s |

---

## GP2 vs GP3 비교

### 최대 성능 달성에 필요한 크기

| 성능 목표 | GP2 필요 크기 | GP3 필요 크기 | 차이 |
|:----------|:--------------|:--------------|:-----|
| **3,000 IOPS** | 1,000 GiB | 20 GiB | **50배 차이** |
| **10,000 IOPS** | 3,334 GiB | 20 GiB | **167배 차이** |
| **16,000 IOPS** | 불가능 | 32 GiB | **GP2 한계** |

### 비용 효율성
```
10,000 IOPS 달성 비용 비교:

GP2: 3,334 GiB × $0.10/GiB = $333.4/월
GP3: 32 GiB × $0.08/GiB + 10,000 IOPS × $0.005 = $52.56/월

결과: GP3가 약 6배 저렴
```

---

## 사용 권장사항

### GP2 권장 시나리오
- **소규모 워크로드** (100~500 GiB)
- **간헐적 고성능** 필요 (버스트 활용)
- **예측 가능한 워크로드**

### GP3 전환 권장 시나리오  
- **1,000 GiB 이상** 필요
- **지속적 고성능** 필요
- **비용 최적화** 중요
- **16,000 IOPS 이상** 필요

---

## 결론

**GP2는 크기에 따라 성능이 선형적으로 증가하지만 한계가 있음**

### 핵심 포인트
1. **3,334 GiB 이후로는 성능 향상 없음** (10,000 IOPS 한계)
2. **1,000 GiB 미만에서만 버스트 혜택** 
3. **GP3 대비 비용 효율성 떨어짐** (고성능 요구시)

### 선택 가이드
- **GP2 유지**: 500 GiB 미만, 간헐적 사용
- **GP3 전환**: 1,000 GiB 이상, 지속적 고성능, 비용 민감

## 참고
참고로 가격도 gp3가 싸다! AWS에서 gp3를 기본 스토리지 티어로 만들기 위함도 있지 최적화가 잘되어있다고 한다.
이왕이면 싸고 좋은걸 써보자

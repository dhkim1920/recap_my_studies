
# Python 메모리 저장 구조 및 참조 방식

## 1. 메모리 구조 개요

Python(CPython)의 메모리는 크게 다음과 같이 나뉩니다:

- 스택 메모리: 함수 호출 시 생성되는 지역 변수와 참조 저장
- 힙 메모리: 실제 객체(숫자, 리스트, 클래스 인스턴스 등)가 저장됨

## 2. 변수

- 변수는 스택 메모리에 저장되며, 실제 데이터는 저장하지 않고 힙의 객체를 참조함
- 예시:

```python
x = 10  # x는 정수 객체 10을 참조
```

## 3. 객체

- 모든 값은 객체이며, 힙 메모리에 저장됨
- 숫자, 문자열, 리스트, 사용자 정의 객체 모두 해당됨

## 4. 함수 및 메서드

- 함수와 메서드도 객체로 간주되어 힙에 저장됨
- 함수 이름은 힙에 있는 함수 객체를 참조하는 변수 역할

```python
def greet():
    print("Hello")

print(greet)  # 함수 객체의 참조
```

## 5. 클래스와 인스턴스

### 클래스

- 클래스 객체는 힙 메모리에 저장됨
- 클래스 네임스페이스에 메서드 및 클래스 변수가 존재

### 인스턴스

- 인스턴스 역시 힙에 저장되며, 인스턴스 변수는 객체의 __dict__에 저장됨

```python
class Person:
    species = "Human"

    def __init__(self, name):
        self.name = name

p = Person("Alice")
```

## 6. 메모리 관리

- Python은 참조 카운팅을 기본 메커니즘으로 사용
- 순환 참조 등 복잡한 경우는 가비지 컬렉터(gc 모듈)가 처리

```python
import gc
gc.collect()  # 수동 수집
```

## 7. 요약 표

| 항목           | 저장 위치         | 설명                                       |
|----------------|------------------|--------------------------------------------|
| 변수           | 스택 메모리       | 객체에 대한 참조 저장                      |
| 객체           | 힙 메모리         | 값 자체 저장                               |
| 함수/메서드    | 힙 메모리         | 함수 객체로 저장                           |
| 클래스         | 힙 메모리         | 클래스 정의 시 메타 객체로 저장           |
| 인스턴스 변수  | 인스턴스 __dict__ | __dict__ 속성에 저장됨                    |
| 클래스 변수    | 클래스 네임스페이스 | 클래스 객체 내부에 존재                    |
